<!doctype html>
{{ partial "head.html" .}}
  <body>
{{ partial "nav.html" .}}

    <main role="main">
      {{ with .Site.GetPage "/publications" }}
      {{range .Pages}}
      {{if in .Params.tags "banner"}}
      <style>
        .topbanner {
          background-image: url({{.Params.image}})
        }
      </style>
        <div class="topbanner">
          <div class="container">
            <div class="row">
            <div class="col-md-12">
              <h1 style="color: #fff;">{{.Params.title}}</h1>
              <p style="color: #fff;">{{.Params.subtitle}}</p>
            </div>
            </div>
        </div>
        </div>
      {{end}}
      {{end}}
      {{end}}
      <div class="container py-5">
  
      {{ with .Site.GetPage "/publications" }}
        {{ partial "featurette.html" .}}
      {{end}}
      
          <br>

          <!-- For demo purpose -->
        <div class="row text-center mb-5">
            <div class="col-lg-12 mx-auto">
                <h1>Publications</h1>
            </div>
        </div><!-- End -->
        <div class="row">
            <div class="col-lg-12 mx-auto">         
                <!-- Timeline -->
                <ul class="timeline" id = "_publications" onscroll="Animate()" style="height:100vh; overflow-y: scroll; overflow-x: hidden;">
                {{with .Site.GetPage "/publications"}}
                {{ range .Pages  }}
                {{if isset .Params "doi"}}
                <li class="timeline-item rounded ml-3 p-4" dt-date ={{.Params.publicationDate}} data-event-date={{.Params.publicationDate}} > 
                    <div class="event_date blue-text">{{.Params.publicationDate}}</div>
                    <h4>{{.Params.title}}</h4>
                    <p>{{delimit .Params.authors ", "}}</p>
                    <p class="journal bold">{{.Params.journal}}<br><span>
                        <span class="badge badge-pill badge-info">{{.Params.doi}}</span>
                    </p>
                </li>
                  {{end}}
                  {{end}}
                  {{end}}
                </ul><!-- End -->
              </div>
          </div>
        </div>
        <!-- /END THE FEATURETTES -->
  
      <!-- /.container -->
    </main>
    {{ partial "footer.html" .}}
    <!-- Optional JavaScript; choose one of the two! -->
  
    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"></script>
      <script src="{{ .Site.BaseURL }}js/rss-parser.min.js"></script>
      <script src="{{ .Site.BaseURL }}js/parser.js"></script>
      <script src="{{ .Site.BaseURL }}js/lab.js"> </script>
    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
      -->
      <script>
 function distanceBetweenElements(elementOne, elementTwo) {
    var div1rect = elementOne.getBoundingClientRect();
    var div2rect = elementTwo.getBoundingClientRect();

// get div1's center point
var div1x = div1rect.left + div1rect.width/2;
var div1y = div1rect.top + div1rect.height/2;

// get div2's center point
var div2x = div2rect.left + div2rect.width/2;
var div2y = div2rect.top + div2rect.height/2;

// calculate the distance using the Pythagorean Theorem (a^2 + b^2 = c^2)
var distanceSquared = Math.pow(div1x - div2x, 2) + Math.pow(div1y - div2y, 2);
var distance = Math.sqrt(distanceSquared);
return distance;
}
const pix = distanceBetweenElements(document.querySelector("li:first-child"), document.querySelector("li:last-child"));



        var ready = (callback) => {
    if (document.readyState != "loading") callback();
    else document.addEventListener("DOMContentLoaded", callback);
  }
        ready(() => { 
    /* Do things after DOM has fully loaded */ 
  
          console.log("Working")
        var container = document.querySelector(".timeline");;
        var items = document.querySelectorAll('.timeline-item');
      items.forEach(
        item=> {
          let BCDATE = item.getAttribute("dt-date");
          var standardDate = new Date(BCDATE).getTime();
          item.setAttribute("data-event-date", standardDate);
         }
      )
  
      var ab = 0;
      Array.from(items).sort( function(a,b){
          a = parseFloat(a.getAttribute("data-event-date"));
          b = parseFloat(b.getAttribute("data-event-date"));
          return a>b ? -1 : a<b ? 1 : 0;
      }).forEach(list =>{
        if(ab %2 == 0){
          ab+=1;
          console.log("adding right")
          list.classList.add("right");
          container.append(list);
        }else{
          ab+=1;
          console.log("adding left")
          list.classList.add("left");
          container.append(list);
        }
      });   
  });

  let scroller = 0;
  function Animate() {
        let heightTimelineBar = document.getElementById('_publications').scrollHeight;
        console.log("Firing event"+heightTimelineBar);
        //   console.log("LENGTH IS"+document.querySelectorAll("li").length);
          let prop = document.querySelector(".timeline").style.getPropertyValue("--barHeight");
            scroller = scroller + 0.1;
          document.querySelector(".timeline").style.setProperty("--barHeight", heightTimelineBar+"px");
  }
  
      </script>
  </body>
  
  </html>